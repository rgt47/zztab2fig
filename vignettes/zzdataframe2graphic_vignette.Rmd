
---
title: "Creating LaTeX Tables and Cropped PDFs from Dataframes"
author: "Ronald G. Thomas"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Creating LaTeX Tables and Cropped PDFs from Dataframes}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

# Introduction

The `zzdataframe2graphic` package provides a streamlined workflow to transform R dataframes into publication-ready LaTeX tables and generate cropped PDF outputs. With built-in options for styling, directory management, and verbose logging, the package is ideal for researchers, analysts, and data scientists who need professional table outputs for reports, presentations, or publications.

This vignette will cover:

1. Installing and loading the package.
2. Key functions and their usage.
3. A complete example of generating LaTeX tables and PDFs.
4. Customization options.
5. Troubleshooting and tips.

# Installation

The package can be installed from CRAN or directly from GitHub if hosted there.

```r
# Install from CRAN
install.packages("zzdataframe2graphic")

# Or install from GitHub
# devtools::install_github("rgt47/zzdataframe2graphic")
```

Load the package:

```r
library(zzdataframe2graphic)
```

# Key Functions

## `d2g()`
The primary function for converting a dataframe to a LaTeX table and generating a cropped PDF.

### Arguments
- `df`: A dataframe to be converted.
- `filename`: Base name of the output files (without extensions). Defaults to the dataframe name.
- `sub_dir`: Subdirectory to store the output files. Default: `"output"`.
- `scolor`: A LaTeX color for alternating row shading (e.g., `"blue!10"`). Default: `"blue!10"`.
- `verbose`: Logical. If `TRUE`, prints progress messages. Default: `FALSE`.

### Returns
- Invisibly returns the path to the cropped PDF.

### Helper Functions
See the full vignette for detailed descriptions of helper functions like `sanitize_column_names()`, `sanitize_table_cells()`, and `create_latex_table()`.

# Example Workflow

## Step 1: Prepare Your Data

Load a dataframe, e.g., the `mtcars` dataset:

```r
data(mtcars)
```

## Step 2: Generate the LaTeX Table and PDF

```r
d2g(
  df = mtcars,
  filename = "mtcars_table",
  sub_dir = "tables",
  scolor = "blue!10",
  verbose = TRUE
)
```

## Step 3: Inspect the Outputs

Navigate to the `tables` subdirectory to find:
- `mtcars_table.tex`: The LaTeX source file.
- `mtcars_table.pdf`: The compiled PDF.
- `mtcars_table_cropped.pdf`: The cropped PDF.

# Customization Options

## Filename and Directory
- Use the `filename` argument to specify a custom base name for output files.
- Use the `sub_dir` argument to organize files into specific directories.

## Styling
Customize alternating row shading with the `scolor` argument. For example:
```r
scolor = "green!20"
```
Valid colors depend on the LaTeX `xcolor` package.

## Verbose Logging
Enable `verbose = TRUE` for detailed progress messages.

# Advanced Use Cases

## Dynamic Dataframes
Use `dplyr` or `data.table` to dynamically prepare data before passing it to `d2g()`.

```r
library(dplyr)

filtered_df <- mtcars %>%
  filter(mpg > 20)

d2g(
  df = filtered_df,
  filename = "filtered_mtcars",
  verbose = TRUE
)
```

## Integrating with Reports
Use the `.tex` file generated by `d2g()` in a larger LaTeX document. Include it using:
```latex
\input{tables/filtered_mtcars.tex}
```

# Troubleshooting

## Error: `pdflatex` or `pdfcrop` not found
Ensure `pdflatex` and `pdfcrop` are installed on your system. For example:
- On Ubuntu: `sudo apt-get install texlive texlive-extra-utils`
- On macOS: Use MacTeX.
- On Windows: Install MiKTeX.

## LaTeX Table Compilation Fails
Check the `.log` file generated during the `pdflatex` step in the output directory for detailed error messages.

# Additional Tips

- **Batch Processing**: Automate table generation for multiple datasets:
```r
datasets <- list(mtcars, iris)
lapply(datasets, function(df) {
  d2g(df, filename = deparse(substitute(df)), verbose = TRUE)
})
```

- **Integration with RMarkdown**: Include the generated PDF in an RMarkdown document:
```markdown
![](tables/mtcars_table_cropped.pdf)
```

# References

- **`kableExtra`**: A package for creating and styling LaTeX/HTML tables in R. [CRAN link](https://cran.r-project.org/package=kableExtra)
- **`pdflatex` and `pdfcrop`**: Tools from TeX distributions like TeX Live and MiKTeX.
- **`zzdataframe2graphic`**: [GitHub link](https://github.com/rgt47/zzdataframe2graphic) (if applicable).

# Conclusion

The `zzdataframe2graphic` package simplifies the process of creating professional-quality tables for publications and presentations. By combining R's data processing capabilities with LaTeX's typesetting power, the package bridges the gap between analysis and presentation, making it an essential tool for any data analyst or researcher.
